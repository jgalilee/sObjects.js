{"note":"Don't delete this file! It's used internally to help with page regeneration.","google":"","body":"# sObjects.js\r\n\r\nCurrently there exists very little documentation about how to use the new Force.com canvas javascript library. This library hopes to remove the difficulty of locating these resources and to provide a friendly wrapper for the existing library making it easier to use and bringing it inline with modern javascript libraries.\r\n\r\n## Building\r\n\r\nBuilding the sObjects.js library requires nodejs, npm and a global installation of the npm jake package.\r\n\r\ngit clone this library and install the node dependencies.\r\n\r\n````shell\r\nsudo npm install dependencies\r\n````\r\n\r\nTo build the sObjects.js library run jake\r\n\r\n````shell\r\njake\r\n````\r\n\r\nThe sobjects.min.js file will now be in the current directory.\r\n\r\n\r\n## Installation\r\n\r\nInstalling the library into a Ruby on Rails or Java application is as easy as adding it to the javascript assets, and making sure that is included correctly.\r\n\r\n## Usage\r\n\r\nDetailed usage can be found at the [sObjects Wiki.](https://github.com/jgalilee/sObjects.js/wiki)\r\n\r\n## Overview\r\n\r\nUsing the sObjects library is simple. Examples for the Force.com canvas require you to setup the request object as follows.\r\n\r\n````js\r\nSfdc.canvas(function() {\r\n  var sr = JSON.parse('<%=signedRequestJson%>');\r\n  Sfdc.canvas.oauth.token(sr.oauthToken);\r\n\r\n  // Code using the canvas goes here.\r\n\r\n});\r\n````\r\n\r\nsObjects simplifies this low level approach by providing a wrapping function. In the background sObjects will curate the data available with the Force.com canvas api and map it into a more robust and semantically enjoyable library.\r\n\r\n````js\r\nSfdc.canvas(function() {\r\n  var sObjects = new sObjects();\r\n  sObjects.instantiate('<%= raw @canvasRequestJson %>', function() {\r\n\r\n    // Code using canvas goes here.\r\n    // Code using sObjects goes here.\r\n\r\n  });\r\n});\r\n````\r\n\r\nsObjects does not mutate the existing library which can still be accessed with ...\r\n\r\n````\r\nsObjects.getBase() // return result of var sr = JSON.parse('<%=signedRequestJson%>');\r\n````\r\n\r\n### Accessing sObjects\r\n\r\nsObjects will load all of the objects that are available in the context of the Force.com canvas. They are accessible as an attribute of sObjects where there name denotes the attribute of sObjects.\r\n\r\nExample: Accounts have the name Account, so the Account sObjects is referenced with …\r\n````js\r\nsObjects.Account\r\n````\r\n\r\nsObjects are not loaded by default. You can force an sObject to load by calling the load method. Loading an sObject retrieves the schema for the sObject and all of its fields. It also prepares the urls required to query and update the sObject.\r\n\r\nsObjects can be loaded with …\r\n````js\r\nsObjects.Account.load(function(result) {\r\n  console.log('sObjects.Account.load callback');\r\n});\r\n````\r\n\r\n### Querying sObjects\r\n\r\nBorrowing from the rails active record and arel libraries sObjects implement their own programatic query interface for constructing SOQL queries.\r\n\r\nWithout sObjects querying the Id and Name fields from the Account records involves the following...\r\n\r\n````js\r\nSfdc.canvas(function() {\r\n  var sr = JSON.parse('<%=signedRequestJson%>');\r\n  Sfdc.canvas.oauth.token(sr.oauthToken); // Save the token\r\n\r\n  var queryUrl = sr.instanceUrl + sr.context.links.queryUrl;\r\n  var soqlQuery = \"SELECT Id, Name FROM Account\";\r\n\r\n  Sfdc.canvas.client.ajax(queryUrl + \"?q=\" + soqlQuery, {\r\n    token: sr.oauthToken,\r\n    method: 'GET',\r\n    contentType: \"application/json\",\r\n    success: function(data) {\r\n      console.log('Found the id and name of all accounts: ', data.payload.records);\r\n    }\r\n  });\r\n});\r\n\r\n````\r\n\r\nUsing sObjects is not only semantically nicer, but allows for easy construction of complex SOQL queries.\r\n\r\n````js\r\nsObjects.Account.find(['Id', 'Name']).all(function(records) {\r\n  console.log('Found the id and name of all accounts: ', records);\r\n});\r\n````\r\n\r\n#### Queries and sObject loading\r\n\r\nsObjects loads all information about sObjects available in the context that canvas app is running. They are then available as a property of sObjects. sObject queries are lazy loaded, specific information about an sObject is only retrieved when required.\r\n\r\nYou can force sObjects to load by calling the load function.\r\n\r\n````js\r\nsObjects.Account.load(function() {\r\n  console.log('sObjects.Account finished loading');\r\n}\r\n````\r\n\r\nIf you do not want to call the load function, this will automatically be called when you do your first query.\r\nIf you chose to do this, your first query will load the sObject details and then perform the query, subsequent\r\nqueries will not call the load method.\r\n\r\n````js\r\n\r\n// First query\r\nsObjects.Account.find(['Id', 'Name']).all(function(records) {\r\n  console.log('Found the id and name of all accounts in an asynchronous callback after load', records);\r\n});\r\n\r\n// Second query\r\nsObjects.Account.find(['Id', 'Name']).all(function(records) {\r\n  console.log('Found the id and name of all accounts in an asynchronous callback ', records);\r\n});\r\n\r\n````\r\n","name":"sObjects.js","tagline":""}